# 软件包

***
## 软件包的分类
***Windows下的.exe可执行程序在Linux是无法识别的***
* 源码包  多是以C语言编写，本身Linux就是C语言编写的
   * 脚本安装包
* 二进制包(RPM包、系统默认包)

***
### 源码包
* 开源，如果自己有能力，可以更改源代码
* 可以自由选择所需的功能
* 软件是编译安装，所以更加适合自己的系统，更加稳定也效率更高
* 卸载方便

* 安装过程步骤较多，容易出现拼写错误
* 编译时间较长，安装比二进制安装时间长
* 因为是编译安装，安装过程中一旦报错新手很难解决

***
### RPM包
二进制包的优点:
* 包管理系统简单，只需要几个命令就可以解决
* 安装的速度比源码包安装快的多
***
二进制包的缺点:
* 经过编译，不再可以看到源代码
* 功能选择不如源代码包灵活
* 依赖性

***
## RPM包管理-rpm命令管理
* RPM包命名原则
```
httpd-2.4.6-80.el7.centos.1.i686.rpm    软件包全名
httpd            软件包名
2.4.6            Version 软件版本
80               软件发布的次数
el7.centos       适合的Linux平台
i686             适合的硬件平台
rpm              rpm包扩展名
```
* RPM包依赖性
   * 树形依赖： a->b->c
   * 环形依赖： a->b->c->a
   * 模块依赖: 模块依赖查询网站: www.rpmfind.net

***
### rpm命令管理-安装升级与卸载
* 包全名：操作的包是没有安装的软件包时，使用包全名。而且要注意路径
* 包名: 操作已经安装的软件包时，使用包名。是搜索 `/var/lib/rpm` 中的数据库
***
RPM安装  rpm -ivh 包全名
* -i install  安装
* -v verbose  显示详细信息
* -h hash    显示进度
* --nodeps   不检测依赖性
***
RPM包升级   rpm -Uvh 包全名
*  -U upgrade   升级
***
卸载  rpm -e 包名
* -e erase    卸载
* --nodeps    不检查依赖性

***
### rpm命令管理-查询
* 查询是否安装
```
查询是否安装     rpm -q 包名              query
查询所有已经安装的rpm包    rpm -qa        query all
查询所有与关键字相关的已安装的包  rpm -qa | grep 包名
```
* 查询软件包的详细信息
```
rpm -qi 包名  查询已安装包的信息  infomation
rpm -qip 包全名 查询未安装包的信息  package
```
* 查询包中文件安装位置
```
rpm -ql 包名   list
rpm -qlp 包全名  查询未安装包文件打算装的位置
```
* 查询系统文件属于哪个rpm包
```
rpm -qf 系统文件名
```
* 查询软件包的依赖性
```
rpm -qR 包名      requires   已安装包
rpm -qRp 包全名              未安装包
```

***
### rpm命令管理-校验和文件提取
* RPM包校验
``` 
确认现在的包的文件和原来默认的包的文件对比有没有做过修改
rpm -V 已安装的包名  verify

验证内容中的8个信息的具体内容如下：
S 文件的大小是否改变
M 文件的类型或文件的权限（rwx）是否改变
5 文件MD5检验和是否改变(可以看成文件内容是否改变)
D 设备的中，从代码是否改变
L 文件的路径是否改变
U 文件的属主(所有者)是否改变
G 文件的属组是否改变
T 文件的修改时间是否改变

文件类型
c 配置文件(config file)
d 普通文档(documentation)
g "鬼"文件(ghost file) ，很少见，就是该文件不应该被这个RPM包包含
l 授权文件(license file)
r 描述文件(read me)
```

* RPM包中文件提取
```
rpm2cpio 将rpm包转化为cpio格式的命令
cpio 是一个标准工具，它用于创建软件档案文件和从档案文件中提取文件

下面表示一条命令没输完！！！！
rpm2cpio 包全名 | \
cpio -idv.文件绝对路径
```

***
## RPM包管理-yum在线管理
### yum在线管理-IP地址配置和网络 `yum` 源
* IP地址配置
```
在这里我就只展示静态IP地址配置
第一步：BOOTPROTO="static"   静态IP地址配置
第二步：ONBOOT="yes"         启动网卡
第三步： 配置IP地址、子网掩码、网关、DNS
第四步： service network restart 重启网络服务

[harrdy@controller ~]$ cat /etc/sysconfig/network-scripts/ifcfg-ens33 
TYPE="Ethernet"
PROXY_METHOD="none"
BROWSER_ONLY="no"
BOOTPROTO="static"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
IPV6_ADDR_GEN_MODE="stable-privacy"
NAME="ens33"
UUID="1eb4cb71-63e5-483d-8ecb-dd9d5d847130"
DEVICE="ens33"
ONBOOT="yes"
IPADDR="192.168.112.133"
NTEMASK="255.255.255.0"
GATEWAY="192.168.112.2"
DNS1="8.8.8.8"
DNS2="8.8.4.4"
[harrdy@controller ~]$ 
```

***
* 网络yum源
```
为什么我们要更换yum源？由于系统自带的yum源的服务器在国外，下载会非常慢，所以会选择国内一些开源的yum源！！！
配置文件路径：/etc/yum.repos.d
参数解释：
[base]       容器名称，一定要放在[]中
name         容器说明，可以自己随便写
mirrorlist   镜像站点，这个可以注释掉
baseurl      我们的yum源服务器的地址。默认是CentOS官方的yum源服务器，是可以使用的，如果你觉得慢可以
             改成你喜欢的yum源地址
enabled      此容器是否生效，如果不写或写成enabled=1都是生效，写成enabled=0就是不生效
gpgcheck     如果是1是指rpm的数字证书生效，如果是0则不生效
gpgkey       数字证书的公钥文件保存位置，不用修改
```

***
### yum在线管理-yum命令
* 查询远程服务器上所有可用软件包列表             yum list
* 搜索服务器上所有和关键字相关的包               yum search  关键字
* 安装                                        yum -y install
* 升级                                        yum -y update 包名
                                              yum -y update 升级所有的软件包包括内核（慎用）
* 卸载                                        yum -y remove 包名  
* 列出所有可用的软件组列表                     yum grouplist
* 安装指定软件组                               yum groupinstall 软件组名
* 卸载指定软件组                              yum groupremove 软件组名


***
### yum在线管理-光盘yum源搭建        没网的情况下，不需要上网，可能不是最新的！！！！
* 用 mount 查看光盘挂载情况
* 让网络yum源失效  可以改名，也可以全部移动到一个新建的文件目录
* 修改光盘yum源文件  vim CentOS-Media.repo 
```
[c7-media]
name=CentOS-$releasever - Media
###############################
baseurl=file:///media/CentOS/              选一个地址为你自己的光盘挂载地址，然后注释掉两个不存在的地址
        file:///media/cdrom/
        file:///media/cdrecorder/
################################        
gpgcheck=1
#enabled=0     将enabled=0 改为 enabled=1 让这个yum源配置文件生效
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-7
```

***
## 源码包与RPM包的区别
* RPM 包默认安装路径
```
/etc/            配置文件安装目录
/usr/bin/        可执行的命令安装目录
/usr/lib/        程序所使用的函数库保存位置
/usr/share/doc/  基本的软件使用手册保存位置
/usr/share/man/  帮助文件保存位置
```
